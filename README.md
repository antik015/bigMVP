# bigMVP
 Code for two stage Bayesian inference for high dimensional binary data under a multivariate probit model. Fo details please refer [here](https://arxiv.org/abs/2106.02127). To run the code, download the Rcpp file and compile it using R function sourceCpp("two_stage_parallel.cpp"). There are two main functions - two_stage_probit_h(), two_stage_probit_nh() for the hierarchical and non-hierarchical versions of the proposed method, respectively. For the non-hierarchical version the arguments are the the binary response matrix (Y), the matrix of covariates (X), variance of the Gaussian prior for the regression coefficients (prior_var), maximum number of iterations allowed for the Laplace approximation (max_it), convergence criteria for the Laplace method (epsilon) and the number of Gauss-Legendre quadrature points used in the second stage approximation. For the hierarchical version the extra parameters are the ones for the Normal-Inverse Wishart prior for the regression coefficients (eta0, nu0, gamma0, Lambda0) where each regression coefficient - <img src="https://latex.codecogs.com/gif.latex?\beta_j \sim \mathrm{NIW}(\eta_0, \nu_0, \gamma_0, \Lambda_0) " /> . The other parameters are the number MCMC iterations for the first stage conditional sampler (nmcmc) and the corresponding burnin itreations (burnin). Refer to the git_run.R file for example run and default choices of these parameters.
